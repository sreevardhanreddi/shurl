{{template "base" .}}

{{define "title"}}Visit Details - {{ .Link.Code }}{{end}}

{{define "content"}}


<!-- Link Information -->
<div class="bg-white dark:bg-dark-200 rounded-lg shadow-lg p-6 mb-8">
  <h2 class="text-xl font-semibold mb-4">Link Information</h2>
  <div class="space-y-4">
    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">URL</label>
      <p class="text-gray-900 dark:text-gray-100 break-all" id="linkUrl">{{ .Link.URL }}</p>
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Short Code</label>
      <a href="/{{ .Link.Code }}" target="_blank" class="text-indigo-600 dark:text-indigo-400 hover:underline"
        id="linkCode">{{ .Link.Code }}</a>
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Total Visits</label>
      <p class="text-gray-900 dark:text-gray-100">{{ len .Visits }}</p>
    </div>
  </div>
</div>

<!-- Visits Table -->
<div class="bg-white dark:bg-dark-200 rounded-lg shadow-lg overflow-hidden">
  <h2 class="text-xl font-semibold p-6">Visits</h2>
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
      <thead class="bg-gray-50 dark:bg-dark-300">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
            IP Address</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
            User Agent</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
            Referrer</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
            Visit Time</th>
        </tr>
      </thead>
      <tbody class="bg-white dark:bg-dark-200 divide-y divide-gray-200 dark:divide-gray-700">
        {{ if .Visits }}
        {{ range .Visits }}
        <tr class="hover:bg-gray-50 dark:hover:bg-dark-300">
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-gray-900 dark:text-gray-100">{{ .IPAddress }}</div>
          </td>
          <td class="px-6 py-4">
            <div class="text-sm text-gray-900 dark:text-gray-100 truncate max-w-md" title="{{ .UserAgent }}">{{
              .UserAgent }}</div>
          </td>
          <td class="px-6 py-4">
            <div class="text-sm text-gray-900 dark:text-gray-100 truncate max-w-xs" title="{{ .Referrer }}">
              {{ if .Referrer }}
              {{ .Referrer }}
              {{ else }}
              -
              {{ end }}
            </div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-gray-900 dark:text-gray-100">{{ .CreatedAt.Format "2006-01-02 15:04:05 MST" }}
            </div>
          </td>
        </tr>
        {{ end }}
        {{ else }}
        <tr>
          <td colspan="4" class="text-center py-4 text-gray-500 dark:text-gray-400">No visits recorded yet.</td>
        </tr>
        {{ end }}
      </tbody>
    </table>
  </div>
</div>
{{end}}

{{/* No page-specific scripts needed for this static page, remove block if empty */}}
{{/*
{{define "scripts"}}
<script>
  // Example: If you needed JS specific to this page
  console.log("Visit details page loaded for link ID: {{ .Link.ID }}");
</script>
{{end}}
*/}}